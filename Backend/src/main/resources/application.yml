spring:
  application:
    name: backend # Jaeger에서 사용

  profiles:
    active: msk

  datasource:
    url: ${SPRING_DATASOURCE_URL}        # PostgreSQL JDBC URL
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${SPRING_DATASOURCE_PASSWORD}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 20  # 기존 10에서 증가
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
      leak-detection-threshold: 0  # 연결 누수 탐지

  jpa:
    hibernate:
      ddl-auto: validate                 # 운영 환경에서는 validate 또는 none
    defer-datasource-initialization: false
    show-sql: true
    properties:
      hibernate:
        format_sql: true
    open-in-view: false

  sql:
    init:
      mode: never
      encoding: UTF-8

  data:
    redis:
      host: ${SPRING_DATA_REDIS_HOST}          # Redis 호스트
      port: ${SPRING_DATA_REDIS_PORT}          # Redis 포트
    elasticsearch:
      repositories:
        enabled: true
  elasticsearch:
    uris: http://172.26.8.129:9200

jwt:
  secret: ${JWT_SECRET}                  # JWT 시크릿
  accessTokenExpirationMs: ${JWT_ACCESSTOKENEXPIRATIONMS}
  refreshTokenExpirationMs: ${JWT_REFRESHTOKENEXPIRATIONMS}

springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    # https
    urls:
      - url: /v3/api-docs
        name: default

logging:
  pattern:
    level: "%5p [traceId=%X{traceId:-},spanId=%X{spanId:-}]"
  level:
    com.zaxxer.hikari: DEBUG
    org.springframework.transaction: DEBUG

gms:
  openai:
    base-url: ${GMS_OPENAI_BASE_URL}
    completions-path: ${GMS_OPENAI_COMPLETIONS_PATH}
    model: ${GMS_OPENAI_MODEL}
    api-key: ${GMS_OPENAI_API_KEY}
    timeout-ms: ${GMS_OPENAI_TIMEOUT_MS}
